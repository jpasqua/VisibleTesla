<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>
			The Notify Tab
		</title>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="../default.css" type="text/css">
		<link rel="shortcut icon" href="../images/favicon.ico?v=1" type="image/x-icon">
		<link rel="icon" href="../images/favicon.ico?v=1" type="image/x-icon">
		<script src="../scripts/gcse.js" type="text/javascript">
</script>
	</head>
	<body>
		<script language="JavaScript" type="text/javascript" src="../scripts/hsp.js">
</script>
		<div id="content">
			<h1>
				The Notify Tab
			</h1>
			<p>
				The Notify tab allows you to request notifications when certain types of events occur. For example, if your state of charge (SOC) drops below a certain level or rises above a certain level. Note that in order to receive a notification, VisibleTesla must be running. If the app is sleeping, notifications may be missed or delayed. For more details, consult the <a href="SleepMode.html">Understanding Sleep Mode</a> section. The following screen shot gives an example of what the Notify Tab looks like. Each notification can be enabled or disabled individually using the associated checkbox.
			</p>
			<p>
				<img class="screenshot" src="../images/24_Notify_Tab.png" alt="Notify Tab">
			</p>
			<p>
				Notifications are sent via email using the address specified in the <a href="PrefsTab.html">Prefs Tab</a>. Many wireless carriers provide an email-to-text gateway where you are provided an email address that corresponds to your mobile phone's phone number. Using such a gateway allows you to receive notifications as text messages. Please note that if you do so, normal text message rates may apply. Consult your carrier for details.
			</p>
			<p>
				Notifications are sent via a hosted service (MailGun). You don't need to enter your email credentials - just an email address. This need not be the same address that you use as your Tesla login. Messages are sent from the address "notifier@visibletesla.com". Do not reply to this address. It is not monitored. Advanced users may use their own MailGun account as described <a href="PrefsTab.html#mailgunkey">here</a>.
			</p>
			<p>
				The following types of notifications are supported:
			</p>
			<table class="grid_table">
				<thead>
					<tr>
						<th>
							Notification
						</th>
						<th>
							Target
						</th>
						<th>
							Description
						</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
							SOC Hits or Exceeds
						</td>
						<td>
							State of Charge percentage (0-100)
						</td>
						<td>
							A notification will be sent if the SOC changes from a value that is below the target value to one that is equal to or greater than the target. You can use this notification if you want to be alerted when your car reaches a certain charge level. Note that the SOC must cross a threshold to get to this value. For example, if you specify 85% as the target, the SOC must go from a value below 85% to 85% or above for a notification to be sent. A notification will not be sent if the SOC is already at or above 85% when the app starts up.
						</td>
					</tr>
					<tr>
						<td>
							SOC Falls Below
						</td>
						<td>
							State of Charge percentage (0-100)
						</td>
						<td>
							A notification will be sent if the SOC changes from a value that is above the target value to one that is less than the target. You can use this notification if you want to be alerted when your car's available charge drops to a certain level.
						</td>
					</tr>
					<tr>
						<td>
							Charge State Becomes
						</td>
						<td>
							<ul style="list-style:none; padding-left:0; margin-top:0;">
								<li>Charging,
								</li>
								<li>Complete,
								</li>
								<li>Disconnected,
								</li>
								<li>Stopped,
								</li>
								<li>Starting,
								</li>
								<li>NoPower,
								</li>
								<li>Unknown,
								</li>
								<li>Anything
								</li>
							</ul>
						</td>
						<td>
							A notification will be sent if the car's charge state changes from some existing value to the specified target value. For example, it might change to <span class="ui">Disconnected</span> when you remove the power cord. If you select <span class="ui">Anything</span> as the target value, then any change in the charge state will cause a notification. <span class="ui">Unknown</span> is a catch-all for any state that is unknown to VisibleTesla. The notification message will contain the current current state of charge (SOC) and estimated remaining range in appropriate units.
						</td>
					</tr>
					<tr>
						<td>
							Speed Hits or Exceeds
						</td>
						<td>
							Speed in mph or km/h
						</td>
						<td>
							A notification will be sent if the speed changes from a value that is below the target value to one that is equal to or greater than the target. This notification will not be sent more frequently than once per 30 minutes. Let's say you set the target to 75 mph and are driving very near that speed. Normal fluctuations in your driving might cause you to drop below then go above 75 mph many times. VisibleTesla will not issue a notification each time that happens. It will issue the first notification and then will not issue another until at least 30 minutes passes.
						</td>
					</tr>
					<tr>
						<td>
							Scheduler Event Triggered
						</td>
						<td>
							N/A
						</td>
						<td>
							A notification will be sent if any scheduled activity occurs.
						</td>
					</tr>
					<tr>
						<td>
							Car entered area
						</td>
						<td>
							An area defined by a center point and a radius in meters
						</td>
						<td>
							A notification will be sent if if your car starts outside of the specified area and later passes into that area. It does not have to stop there. See below for instructions on setting the area.
						</td>
					</tr>
					<tr>
						<td>
							Car left area
						</td>
						<td>
							An area defined by a center point and a radius in meters.
						</td>
						<td>
							A notification will be sent if if your car starts inside of the specified area and later leaves that area. See below for instructions on setting the area.
						</td>
					</tr>
				</tbody>
			</table>
			<h2>
				<a name="locs">Defining Locations</a>
			</h2>
			<p>
				When using the <span class="ui">Car entered area</span> or <span class="ui">Car left area</span> notifications, you must define the area of interest. An area is defined by a location and a radius which are set via an options dialog box. You get to that dialog box by pressing the <span class="ui">Define Area</span> button next to the <span class="ui">Car entered area</span> or <span class="ui">Car left area</span> checkboxes. The dialog you get looks like a normal Google map as shown in the screen shot below.
			</p>
			<p>
				<img class="screenshot" src='../images/24b_Map_Default.png' alt='Notify Tab'>
			</p>
			<p>
				You'll see a red arrow representing the selected location and blue circle around it representing the radius. The first time you bring up this dialog, the arrow will appear at the Tesla factory in Fremont, CA. Use the search box to navigate to a new location. As shown in the screen shot below, as you type you will see an auto-complete list of possible locations.
			</p>
			<p>
				<img class="screenshot" src='../images/24c_Map_Auto.png' alt='Notify Tab'>
			</p>
			<p>
				Choose one of those locations or hit <span class="ui">Enter</span>. The map will relocate to show the selected location as shown below. Now you can begin to refine the location and radius. Use the normal map controls to zoom and pan as needed. To relocate the arrow, simply click and drag it to a new location. To change the radius, grab the white knob and drag it in or out. The blue circle will grow or shrink to show the new radius. VisibleTesla will not allow you to set a radius below 15 meters.
			</p>
			<p>
				<img class="screenshot" src='../images/24d_Map_Result.png' alt='Notify Tab'>
			</p>
			<p>
				<img class="screenshot" src='../images/24e_Map_Manipulate.png' alt='Notify Tab'>
			</p>
			<p>
				When you've got the location and size the way you want them, enter a nickname for this location such as Home or Work. The nickname will be used as part of notification messages. If you don't enter a nickname you may see a latitude / longitude in notification messages. After setting the nickname, just press <span class="ui">OK</span>. You can cancel at any time by pressing the <span class="ui">Cancel</span> button. In this case your previous values will not be changed.
			</p>
			<p>
				<img class="screenshot" src='../images/24f_Map_Nickname.png' alt='Notify Tab'>
			</p>
			<h2>
				<a name="custom_messages">Customizing Notifications</a>
			</h2>
			<p>
				VisibleTesla allows you to optionally specify the email address, subject and message body to use for each type of notification. The email address may be a comma-separated list of addresses if you'd like the message to go to more than one recipient.
			</p>
			<p>
				Custom notifications can be useful in a number of circumstances. For example, you may wish to use email notifications for most things, but use text messages for urgent notifications. For urgent notifications you could enter a text message address instead of your default email address. You could also use this feature if you wish to develop mail rules that kick off some activity based on a recipient email address and/or subject line.</p>
			<p>
				To access these options, press the <span class="ui">+ button</span> at the far right of any notification definition. A dialog will pop up (see below) allowing you to specify an email address, subject, and message.
			</p>
			<p>
				You may also select <span class="ui">Use default values</span>, in which case the default email address, subject, and message will be used. If you leave any field blank, the default will be used for the blank item(s).
			</p>
			<p>
				<img class="screenshot" src='../images/24a_Notify_Options.png' alt='Notify Tab'>
			</p>
			<h3>
				Advanced Feature: Defining your own message using variables
			</h3>
			<p>
				By default, VisibleTesla sends notification messages that include information relevant to each type of notification. For example, if you set up a <span class="ui">Speed Hits or Exceeds</span> notification, the app will tell you both the target speed (e.g. 75 mi/h) and the current speed (e.g. 80 mi/h).
			</p>
			<p>
				You may want to customize the message that is sent for a given notification to include different information, different text, or use your native language. To facilitate that, VisibleTesla allows you to set a custom message as described above. However, to make that message meaningful, you'll need to specify the information you'd like to include such as the current speed, target speed, or state of charge. You can specify those values by using special keywords in your message. Those words are listed below and are always delimited by double curly braces: {{ and }}. We refer to these keywords as variables.
			</p>
			<table class="grid_table">
				<tr>
					<th>
						<code>Variable Name</code>
					</th>
					<th>
						Substituted By
					</th>
				</tr>
				<tr>
					<td>
						<code>{{SPEED}}</code>
					</td>
					<td>
						The last known speed of the vehicle in the units set by the car (mph or km/h)
					</td>
				</tr>
				<tr>
					<td>
						<code>{{SOC}}</code>
					</td>
					<td>
						The last known state of charge. This is a percentage.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{IDEAL}}</code><br>
						<code>{{HT_IDEAL_G}}</code>
					</td>
					<td>
						The last known ideal range of the vehicle in the units set by the car (mi or km). If you use <code>{{HT_IDEAL_G}}</code>, a gauge will be generated using HTML. <strong>Important Note:</strong> This isn't currently useful for notification messages since they are sent as plain text rather than html. Currently this is only used by the built-in web pages.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{RATED}}</code><br>
						<code>{{HT_RATED_G}}</code>
					</td>
					<td>
						The last known rated range of the vehicle in the units set by the car (mi or km). If you use <code>{{HT_RATED_G}}</code>, a gauge will be generated using HTML. <strong>Important Note:</strong> This isn't currently useful for notification messages since they are sent as plain text rather than html. Currently this is only used by the built-in web pages.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{ESTIMATED}}</code><br>
						<code>{{HT_ESTIMATED_G}}</code>
					</td>
					<td>
						The last known estimated range of the vehicle in the units set by the car (mi or km). If you use <code>{{HT_ESTIMATED_G}}</code>, a gauge will be generated using HTML. <strong>Important Note:</strong> This isn't currently useful for notification messages since they are sent as plain text rather than html. Currently this is only used by the built-in web pages.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{CHARGE_STATE}}</code>
					</td>
					<td>
						The last known charge state of the vehicle (e.g. Disconnected or Stopped)
					</td>
				</tr>
				<tr>
					<td>
						<code>{{D_UNITS}}</code>
					</td>
					<td>
						The distance units in used by the vehicle (mi or km)
					</td>
				</tr>
				<tr>
					<td>
						<code>{{S_UNITS}}</code>
					</td>
					<td>
						The speed units in used by the vehicle (mph or km/h)
					</td>
				</tr>
				<tr>
					<td>
						<code>{{TARGET}}</code>
					</td>
					<td>
						The target value of the notification. For example, if a notification was set for <span class="ui">Speed Hits or Exceeds 75.0</span>, then the target value would be 75.0
					</td>
				</tr>
				<tr>
					<td>
						<code>{{CUR}}</code>
					</td>
					<td>
						The current value of the item being monitored for the notification. For example, if a notification was set for <span class="ui">Speed Hits or Exceeds 75.0</span>, and the car hit 76.3 mi/h, then the value would be 76.3. As another example, if a <span class="ui">Car entered area</span> notification was triggered, and the defined area had a nickname of "Home" and a radius of 20 meters, this variable would be "[Home] within 20 meters".
					</td>
				</tr>
				<tr>
					<td>
						<code>{{DATE}}</code>
					</td>
					<td>
						The current date in the form YYYY-MM-DD. For example, 2014-12-25.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{TIME}}</code>
					</td>
					<td>
						The current time in 24 hour format HH:MM:SS. For example, 20:12:35. Note that this is the time the message was generated which will be different from the time that you receive the message. How different depends on how long it takes for your message to be delivered. Note also that the time the message is generated may be later than the time the event actually occurred. It is usually pretty close, but may be quite a bit different if the app has been in sleep mode.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{LOC}}</code><BR>
						<code>{{HT_LOC}}</code>
					</td>
					<td>
						The last known location of the vehicle. The location presented is derived by taking the last known latitude and longitude and asking Google for the closest known address. If Google cannot produce a result, the raw latitude and longitude will be presented. If you use <code>{{HT_LOC}}</code>, the resulting string will be wrapped in an HTML link that points to a Google map centered on the given position.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{I_MODE}}</code>
					</td>
					<td>
						The app's inactivity mode, which could be <span class="ui">Stay Awake</span>, <span class="ui">Allow Daydreaming</span>, or <span class="ui">Allow Sleeping</span>. This corresponds to the setting of the <span class="ui">Options&rarr;Inactivity Mode</span> menu. 
					</td>
				</tr>
				<tr>
					<td>
						<code>{{I_STATE}}</code>
					</td>
					<td>
						The app's inactivity state, which could be <span class="ui">Awake</span>, <span class="ui">Daydreaming</span>, or <span class="ui">Sleeping</span>. Note that the app might be in <span class="ui">Allow Sleeping</span> mode, but still not be asleep. It only goes to sleep when in that mode <strong>and</strong> there is no user activity for 15 minutes. The same is true for <span class="ui">Allow Daydreaming</span> mode
					</td>
				</tr>
				<tr>
					<td>
						<code>{{P_CURRENT}}</code>
					</td>
					<td>
						The pilot current being supplied to the car. When your car is plugged in, this value will indicate the power that is available to be supplied to your car when charging begins. When your car is not plugged in, this value will be 0. It is possible for this value to be -1 which indicates that the car did not report the pilot current.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{TIME_TO_FULL}}</code>
					</td>
					<td>
						The amount of time left until the current charge completes. If there is not a charge in progress, TIME_TO_FULL will be zero. This is formatted as HH:MM:SS (hours:minutes:seconds).
					</td>
				</tr>
				<tr>
					<td>
						<code>{{C_RATE}}</code>
					</td>
					<td>
						The rate at which range is being added back to your vehicle by the current charge cycle. This will be reported in the units set by the car (mi/h or km/h).
					</td>
				</tr>
				<tr>
					<td>
						<code>{{C_AMP}}</code>
					</td>
					<td>
						The current in amps flowing into the battery (or out if negative).
					</td>
				</tr>
				<tr>
					<td>
						<code>{{C_VLT}}</code>
					</td>
					<td>
						The voltage being supplied to the vehicle.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{C_PWR}</code>
					</td>
					<td>
						The power in kW being supplied at the moment the reading was taken.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{ODO}</code>
					</td>
					<td>
						Displays the last known odometer reading in the units set by the car (mi or km).
					</td>
				</tr>
				<tr>
					<td>
						<code>{{HT_SOC_G}</code>
					</td>
					<td>
						Generates an HTML snippet that displays the state of charge in the form of a battery gauge. The image also displays a plug symbol if the car is currently being charged.<br>
						<strong>Important Note:</strong> This isn't currently useful for notification messages since they are sent as plain text rather than html. Currently this is only used by the built-in web pages.
					</td>
				</tr>
				<tr>
					<td>
						<code>{{HT_ODO}</code>
					</td>
					<td>
						Generates an HTML snippet that displays the last known odometer reading in a form that looks like an old fashioned physical odometer. The value is displayed in the units set by the car (mi or km).<br>
						<strong>Important Note:</strong> This isn't currently useful for notification messages since they are sent as plain text rather than html. Currently this is only used by the built-in web pages.
					</td>
				</tr>
				<tr>
					<td></td>
					<td>
						<strong>In the future, other variables may be added to the list</strong>
					</td>
				</tr>
			</table>
			<p>
				Let's look at an example. Say we want to add a custom message to the <span class="ui">Charge State Becomes</span> notification. We want it to tell us the new charge state, the SOC, and the ideal and rated ranges. We could enter a message that looks like this:
			</p>
			<blockquote>
				<code>
					{{DATE}} {{TIME}}<br>
					Charge State: {{CHARGE_STATE}}<br>
					SOC: {{SOC}}%<br>
					Range ({{D_UNITS}}): Rated={{RATED}}, Ideal={{IDEAL}}</code>
			</blockquote>
			<p>
				This might produce a message such as:
			</p>
			<blockquote>
				<code>
					2014-06-03 10:00:00<br />
					Charge State: Complete<br />
					SOC: 90%<br />
					Range (mi): Rated=177, Ideal=184
				</code>
			</blockquote>
			<p>
				You can use as many or as few variables as you'd like and they don't have to be related to the particular type of notification. For example, you can include the estimated range and/or SOC in every notification that you send.
			</p>
			<p>
				You can also use variables in subject lines. Let's look at a couple of examples that might be used for the <span class="ui">Charge State Becomes</span> notification:
			</p>
			<table class="grid_table">
				<tr>
					<th>
						Subject field
					</th>
					<th>
						Example output
					</th>
				</tr>
				<tr>
					<td>
						<code>Charge State: {{CHARGE_STATE}}</code>
					</td>
					<td>
						<code>Charge State: Stopped</code>
					</td>
				</tr>
				<tr>
					<td>
						<code>Charge State: {{CHARGE_STATE}}, SOC: {{SOC}}%</code>
					</td>
					<td>
						<code>Charge State: Stopped, SOC: 80%</code>
					</td>
				</tr>
			</table>
			<p>
				<strong>Note</strong>: Variable names must be entered exactly and must always include the double curly braces. <code>{{Soc}</code> is not a substitute for <code>{{SOC}</code>; nor is <code>SOC</code>. It really needs to be an exact match to the items listed in the table above. You may not use double curly braces as part of the content of your message. Anything enclosed in double curly braces will be interpreted as a variable name.
			</p>
			<h2>
				Accessing a URL: Advanced Users Only
			</h2>
			<p>
				When a notification occurs, VisibleTesla can perform an <code>HTTP GET</code> on a URL instead of sending an email. This mechanism allows notifications to trigger web services for home automation or other purposes. To use this feature, set the notification email in any custom notification setting to a URL rather than an email address. The URL must begin with <code>http://</code> or <code>https://</code>. It must be a fully formed URL with any special characters URL-encoded. If VisibleTesla sees a URL rather than an email, it will perform an <code>HTTP GET</code> on that URL. It <strong>will not</strong> check error codes returned from the server nor process any returned data. The custom subject field will be ignored.
			</p>
			<p>
				A sample use case might be turning on outside lights at your home when your car is approaching. To do this you would start by setting up the <span class="ui">Car entered area</span> notification. You would then press the <span class="ui">+ button</span> to bring up the custom address dialog as shown below. Now you can enter the URL corresponding to the "Lights On" command of your home automation controller. Put it in the <span class="ui">EMail</span> field where you would normally put an email address.
			</p>
			<p>
				<img class="screenshot" src='../images/24g_Enter_Custom.png' alt='Notify Tab'>
			</p>
			<p>
				<strong>Security Note:</strong> Any information you enter in this field will be stored unencrypted on your computer's local disk. Be aware of that if you encode sensitive information into a URL.
			</p>
		</div>
		<div id="footer"></div>
	</body>
</html>